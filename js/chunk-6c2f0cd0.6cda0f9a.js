(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c2f0cd0","chunk-2d0aeeb8"],{"0bb2":function(e,t,a){"use strict";a.r(t);a("3324");var r=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:e.title,center:"",visible:e.show,width:"30%",top:"5%","close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.show=t}}},[t("el-input",{attrs:{placeholder:"输入关键字进行过滤",size:"small"},model:{value:e.filterText,callback:function(t){e.filterText="string"===typeof t?t.trim():t},expression:"filterText"}}),t("el-checkbox",{on:{change:function(t){return e.handleCheckedTreeNodeAll(t)}},model:{value:e.menuNodeAll,callback:function(t){e.menuNodeAll=t},expression:"menuNodeAll"}},[e._v("全选/全不选")]),t("el-scrollbar",{staticStyle:{height:"60vh"}},[t("el-tree",{ref:"tree",attrs:{data:e.menuList,"show-checkbox":"","node-key":"id",props:e.defaultProps,"default-expanded-keys":e.expandedKeys,"check-strictly":"","filter-node-method":e.filterNode}})],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e._sever}},[e._v("确 定")])],1)],1)},o=[],s=a("7c3e"),n=a("41e4"),l=a("00f8"),i=a("6730"),c=(a("df89"),a("c048"),a("e1a1"),a("6eef")),d=a("562c"),u=a("ed08"),m={name:"",props:{show:{type:Boolean,default:!1},row:{type:Object,default:function(){}},title:{type:String,default:"角色权限"}},data:function(){return{menuList:[],filterText:"",menuNodeAll:!1,defaultProps:{children:"children",label:"title"},expandedKeys:[],menuOptions:[]}},watch:{filterText:function(e){this.$refs.tree.filter(e)}},mounted:function(){this.init()},computed:Object(i["a"])({},Object(c["d"])("user",["roles"])),methods:Object(i["a"])(Object(i["a"])({},Object(c["b"])("system",["getRolesMenus","rolesSever"])),{},{init:function(){var e=this;return Object(l["a"])(Object(s["a"])().mark((function t(){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getRolesMenus();case 2:e.menuOptions=t.sent,e.menuList=Object(d["a"])(Object(d["f"])(e.menuOptions),!1),e.expandedKeys=e.row.menus.map((function(e){return e.id})),e.$nextTick((function(){e.expandedKeys.length==e.menuOptions.length&&(e.menuNodeAll=!0),e.$refs.tree.setCheckedKeys(Object(n["a"])(e.expandedKeys))}));case 6:case"end":return t.stop()}}),t)})))()},handleCheckedTreeNodeAll:function(e){this.$refs.tree.setCheckedNodes(e?this.menuOptions:[])},filterNode:function(e,t){return!e||-1!==t.title.indexOf(e)},_sever:function(){var e=this;return Object(l["a"])(Object(s["a"])().mark((function t(){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return Object(u["d"])("正在保存"),t.next=3,e.rolesSever({id:e.row.id,menus:e.$refs.tree.getCheckedKeys()});case 3:e.handleClose();case 4:case"end":return t.stop()}}),t)})))()},handleClose:function(){this.$refs.tree.setCheckedKeys([]),this.expandedKeys=[],this.$emit("_close")}})},p=m,f=a("0460"),h=Object(f["a"])(p,r,o,!1,null,null,null);t["default"]=h.exports},"2e64":function(e,t,a){"use strict";a.r(t);a("3324");var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"table-page"},[t("div",{staticClass:"queryInfo"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{sm:8,md:6}},[t("el-input",{attrs:{size:"small",placeholder:"请输入角色名称"},model:{value:e.queryInfo.params.roleName,callback:function(t){e.$set(e.queryInfo.params,"roleName","string"===typeof t?t.trim():t)},expression:"queryInfo.params.roleName"}})],1),t("el-col",{attrs:{sm:8,md:6}},[t("el-date-picker",{attrs:{type:"daterange",size:"small",clearable:!1,placement:"bottom-start","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"创建日期","end-placeholder":"结束日期"},model:{value:e.queryInfo.params.time,callback:function(t){e.$set(e.queryInfo.params,"time",t)},expression:"queryInfo.params.time"}})],1),t("el-col",{attrs:{sm:8,md:6}},[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"query",expression:"'query'"}],attrs:{type:"primary",size:"small"},on:{click:function(t){return e.handleSizeChange()}}},[e._v("搜索")]),t("el-button",{attrs:{size:"small"},on:{click:function(t){return e.reset_query()}}},[e._v("重置")])],1)],1)],1),t("div",{staticClass:"main_list"},[t("div",{staticClass:"button_group"},[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"add",expression:"'add'"}],attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:function(t){return e.showDialogAdd(0)}}},[e._v("新增")])],1),t("el-table",{attrs:{border:"",size:"small","row-key":"id",data:e.tableData}},[t("el-table-column",{attrs:{prop:"roleName",width:"150",label:"角色名称"}}),t("el-table-column",{attrs:{prop:"roleDesc",label:"角色描述"}}),t("el-table-column",{attrs:{label:"角色状态",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[t("el-tag",{attrs:{effect:"dark",type:r.state?"danger":"success",size:"medium"}},[e._v(e._s(r.state?"禁用":"启用"))])]}}])}),t("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e._f("dateFormat")(a.createdAt))+" ")]}}])}),t("el-table-column",{attrs:{label:"修改时间"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v(" "+e._s(e._f("dateFormat")(a.updatedAt))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"155"},scopedSlots:e._u([{key:"default",fn:function(a){var r=a.row;return[t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"update",expression:"'update'"}],staticClass:"textyell",attrs:{type:"text",size:"mini"},on:{click:function(t){return e.showDialogAdd(r)}}},[e._v("修改")]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"delete",expression:"'delete'"}],staticClass:"textRed",attrs:{type:"text",size:"mini"},on:{click:function(t){return e.remove(r.id)}}},[e._v("删除")]),t("el-button",{directives:[{name:"permission",rawName:"v-permission",value:"update:role",expression:"'update:role'"}],staticClass:"textym",attrs:{type:"text",size:"mini"},on:{click:function(t){return e.handleCommand(r)}}},[e._v("修改权限")])]}}])})],1),t("ak-pagination",{attrs:{total:e.total,"page-size":e.queryInfo.limit,"current-page":e.queryInfo.offset},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:e.dialog.title,visible:e.dialog.show,"close-on-click-modal":!1,width:"500px","before-close":e.handleClose},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[t("el-form",{ref:"addFormData",attrs:{model:e.addFormData,rules:e.formRules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"角色名称",prop:"roleName"}},[t("el-input",{model:{value:e.addFormData.roleName,callback:function(t){e.$set(e.addFormData,"roleName","string"===typeof t?t.trim():t)},expression:"addFormData.roleName"}})],1),t("el-form-item",{attrs:{label:"角色编码",prop:"roleCode"}},[t("el-input",{model:{value:e.addFormData.roleCode,callback:function(t){e.$set(e.addFormData,"roleCode","string"===typeof t?t.trim():t)},expression:"addFormData.roleCode"}})],1),t("el-form-item",{attrs:{label:"角色描述",prop:"roleDesc"}},[t("el-input",{attrs:{type:"textarea",rows:"3"},model:{value:e.addFormData.roleDesc,callback:function(t){e.$set(e.addFormData,"roleDesc","string"===typeof t?t.trim():t)},expression:"addFormData.roleDesc"}})],1),t("el-form-item",{attrs:{label:"角色状态"}},[t("el-select",{model:{value:e.addFormData.state,callback:function(t){e.$set(e.addFormData,"state",t)},expression:"addFormData.state"}},[t("el-option",{attrs:{label:"启用",value:!1}}),t("el-option",{attrs:{label:"禁用",value:!0}})],1)],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.sever_Role}},[e._v("确 定")])],1)],1),e.rolePermissions?t("role-permissions",{attrs:{show:e.rolePermissions,row:e.roleRow,title:e.title},on:{_close:e.handleClose}}):e._e()],1)},o=[],s=a("7c3e"),n=a("00f8"),l=a("6730"),i=(a("c048"),a("8241"),a("4ee5"),a("6eef")),c=a("ed08"),d=a("0bb2"),u={components:{RolePermissions:d["default"]},data:function(){return{total:0,pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},dialog:{title:"新增",show:!1},queryInfo:{params:{},limit:15,offset:1,sort:{prop:"createdAt",order:"desc"}},tableData:[],addFormData:{state:!1},formRules:{roleName:[{required:!0,message:"请输入角色名称",trigger:"blur"}]},dialogVisible:!1,roleId:null,rolePermissions:!1,title:"",roleRow:null}},computed:{},mounted:function(){this.seach_query()},methods:Object(l["a"])(Object(l["a"])({},Object(i["b"])("system",["rolesSever","rolesList","rolesPreservation","rolesRome"])),{},{seach_query:function(){var e=this;return Object(n["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return Object(c["d"])("加载中"),e.queryInfo.params.time&&(e.queryInfo.params.endTime=e.$dateFormat(e.queryInfo.params.time[1]).replace(/00:00:00/,"23:59:59"),e.queryInfo.params.startTime=e.$dateFormat(e.queryInfo.params.time[0])),t.next=4,e.rolesList(Object(l["a"])({},e.queryInfo));case 4:a=t.sent,e.tableData=a.data,e.total=a.count;case 7:case"end":return t.stop()}}),t)})))()},beforeHandleCommand:function(e,t){return{row:e,command:t}},showDialogAdd:function(e){e?(this.addFormData=Object(l["a"])({},e),this.dialog.title="修改"):(this.dialog.title="新增",this.addFormData.state=!1),this.dialog.show=!0},sever_Role:function(){var e=this;this.$refs["addFormData"].validate(function(){var t=Object(n["a"])(Object(s["a"])().mark((function t(a){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return",!1);case 2:return Object(c["d"])(!0),t.next=5,e.rolesSever({id:e.addFormData.id,roleName:e.addFormData.roleName,roleDesc:e.addFormData.roleDesc,roleCode:e.addFormData.roleCode,state:e.addFormData.state,menus:e.addFormData.menus.map((function(e){return e.id}))});case 5:e.handleClose();case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleCommand:function(e){this.roleRow=e,this.title="（".concat(e.roleName,"）角色权限"),this.rolePermissions=!0},remove:function(e){var t=this;Object(c["a"])("确认删除","提示",{ok:function(){var a=Object(n["a"])(Object(s["a"])().mark((function a(){return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return Object(c["d"])("正在删除"),a.next=3,t.rolesRome({id:[e]});case 3:t.seach_query();case 4:case"end":return a.stop()}}),a)})));function r(){return a.apply(this,arguments)}return r}()})},reset_query:function(){this.queryInfo={params:{},limit:15,offset:1,sort:{prop:"createdAt",order:"desc"}}},handleClose:function(){this.dialog.show=!1,this.addFormData={ena:1},this.rolePermissions=!1,this.seach_query()},handleSizeChange:function(e){this.queryInfo.limit=e||this.queryInfo.limit,this.queryInfo.offset=1,this.seach_query()},handleCurrentChange:function(e){this.queryInfo.offset=e||1,this.seach_query()}})},m=u,p=a("0460"),f=Object(p["a"])(m,r,o,!1,null,null,null);t["default"]=f.exports}}]);