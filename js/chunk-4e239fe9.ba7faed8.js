(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e239fe9"],{1724:function(t,e,s){},"5faa":function(t,e,s){"use strict";s("1724")},8190:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"sign"},[e("div",{staticClass:"sign-canvas"},[e("vue-esign",{ref:"esign",staticClass:"esign",attrs:{isCrop:t.isCrop,lineWidth:t.lineWidth,lineColor:t.lineColor}})],1),e("div",{staticClass:"sign-btn"},[e("el-button",{attrs:{type:"danger"},on:{click:t.emptySing}},[t._v("清空")]),e("el-button",{attrs:{type:"success"},on:{click:t.okSign}},[t._v("确定")]),e("el-button",{attrs:{type:"primary"},on:{click:t.viewSign}},[t._v("查看签名")])],1),t.imgShow?e("img",{staticClass:"img",attrs:{src:t.resultImg}}):t._e()])},a=[],n=function(){var t=this,e=t._self._c;return e("canvas",{ref:"canvas",on:{mousedown:t.mouseDown,mousemove:t.mouseMove,mouseup:t.mouseUp,touchstart:t.touchStart,touchmove:t.touchMove,touchend:t.touchEnd}})},o=[],r=s("41e4"),h=(s("65a7"),s("2a49"),s("e1a1"),{props:{width:{type:Number,default:800},height:{type:Number,default:300},lineWidth:{type:Number,default:4},lineColor:{type:String,default:"#000000"},bgColor:{type:String,default:""},isCrop:{type:Boolean,default:!1},isClearBgColor:{type:Boolean,default:!0},format:{type:String,default:"image/png"},quality:{type:Number,default:1}},data:function(){return{hasDrew:!1,resultImg:"",points:[],canvasTxt:null,startX:0,startY:0,isDrawing:!1,sratio:1}},computed:{ratio:function(){return this.height/this.width},stageInfo:function(){return this.$refs.canvas.getBoundingClientRect()},myBg:function(){return this.bgColor?this.bgColor:"rgba(255, 255, 255, 0)"}},watch:{myBg:function(t){this.$refs.canvas.style.background=t}},beforeMount:function(){window.addEventListener("resize",this.$_resizeHandler)},beforeDestroy:function(){window.removeEventListener("resize",this.$_resizeHandler)},mounted:function(){var t=this,e=this.$refs.canvas;e.height=this.height,e.width=this.width,e.style.background=this.myBg,this.$_resizeHandler(),document.onmouseup=function(){t.isDrawing=!1}},methods:{$_resizeHandler:function(){var t=this.$refs.canvas;t.style.width=this.width+"px";var e=parseFloat(window.getComputedStyle(t).width);t.style.height=this.ratio*e+"px",this.canvasTxt=t.getContext("2d"),this.canvasTxt.scale(1*this.sratio,1*this.sratio),this.sratio=e/this.width,this.canvasTxt.scale(1/this.sratio,1/this.sratio)},mouseDown:function(t){t=t||event,t.preventDefault(),this.isDrawing=!0,this.hasDrew=!0;var e={x:t.offsetX,y:t.offsetY};this.drawStart(e)},mouseMove:function(t){if(t=t||event,t.preventDefault(),this.isDrawing){var e={x:t.offsetX,y:t.offsetY};this.drawMove(e)}},mouseUp:function(t){t=t||event,t.preventDefault();var e={x:t.offsetX,y:t.offsetY};this.drawEnd(e),this.isDrawing=!1},touchStart:function(t){if(t=t||event,t.preventDefault(),this.hasDrew=!0,1===t.touches.length){var e={x:t.targetTouches[0].clientX-this.$refs.canvas.getBoundingClientRect().left,y:t.targetTouches[0].clientY-this.$refs.canvas.getBoundingClientRect().top};this.drawStart(e)}},touchMove:function(t){if(t=t||event,t.preventDefault(),1===t.touches.length){var e={x:t.targetTouches[0].clientX-this.$refs.canvas.getBoundingClientRect().left,y:t.targetTouches[0].clientY-this.$refs.canvas.getBoundingClientRect().top};this.drawMove(e)}},touchEnd:function(t){if(t=t||event,t.preventDefault(),1===t.touches.length){var e={x:t.targetTouches[0].clientX-this.$refs.canvas.getBoundingClientRect().left,y:t.targetTouches[0].clientY-this.$refs.canvas.getBoundingClientRect().top};this.drawEnd(e)}},drawStart:function(t){this.startX=t.x,this.startY=t.y,this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(t.x,t.y),this.canvasTxt.lineCap="round",this.canvasTxt.lineJoin="round",this.canvasTxt.lineWidth=this.lineWidth*this.sratio,this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.points.push(t)},drawMove:function(t){this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(t.x,t.y),this.canvasTxt.strokeStyle=this.lineColor,this.canvasTxt.lineWidth=this.lineWidth*this.sratio,this.canvasTxt.lineCap="round",this.canvasTxt.lineJoin="round",this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.startY=t.y,this.startX=t.x,this.points.push(t)},drawEnd:function(t){this.canvasTxt.beginPath(),this.canvasTxt.moveTo(this.startX,this.startY),this.canvasTxt.lineTo(t.x,t.y),this.canvasTxt.lineCap="round",this.canvasTxt.lineJoin="round",this.canvasTxt.stroke(),this.canvasTxt.closePath(),this.points.push(t),this.points.push({x:-1,y:-1})},generate:function(t){var e=this,s=t&&t.format?t.format:this.format,i=t&&t.quality?t.quality:this.quality,a=new Promise((function(t,a){if(e.hasDrew){var n=e.canvasTxt.getImageData(0,0,e.$refs.canvas.width,e.$refs.canvas.height);e.canvasTxt.globalCompositeOperation="destination-over",e.canvasTxt.fillStyle=e.myBg,e.canvasTxt.fillRect(0,0,e.$refs.canvas.width,e.$refs.canvas.height),e.resultImg=e.$refs.canvas.toDataURL(s,i);var o=e.resultImg;if(e.canvasTxt.clearRect(0,0,e.$refs.canvas.width,e.$refs.canvas.height),e.canvasTxt.putImageData(n,0,0),e.canvasTxt.globalCompositeOperation="source-over",e.isCrop){var h,c=e.getCropArea(n.data),u=document.createElement("canvas"),l=u.getContext("2d");u.width=c[2]-c[0],u.height=c[3]-c[1];var v=(h=e.canvasTxt).getImageData.apply(h,Object(r["a"])(c));l.globalCompositeOperation="destination-over",l.putImageData(v,0,0),l.fillStyle=e.myBg,l.fillRect(0,0,u.width,u.height),o=u.toDataURL(s,i),u=null}t(o)}else a("Warning: Not Signned!")}));return a},reset:function(){this.canvasTxt.clearRect(0,0,this.$refs.canvas.width,this.$refs.canvas.height),this.isClearBgColor&&(this.$emit("update:bgColor",""),this.$refs.canvas.style.background="rgba(255, 255, 255, 0)"),this.points=[],this.hasDrew=!1,this.resultImg=""},getCropArea:function(t){for(var e=this.$refs.canvas.width,s=0,i=this.$refs.canvas.height,a=0,n=0;n<this.$refs.canvas.width;n++)for(var o=0;o<this.$refs.canvas.height;o++){var r=4*(n+this.$refs.canvas.width*o);(t[r]>0||t[r+1]>0||t[r+2]||t[r+3]>0)&&(a=Math.max(o,a),s=Math.max(n,s),i=Math.min(o,i),e=Math.min(n,e))}e++,s++,i++,a++;var h=[e,i,s,a];return h}}}),c=h,u=(s("5faa"),s("0460")),l=Object(u["a"])(c,n,o,!1,null,"6386dd1a",null),v=l.exports;v.install=function(t){this.installed||(this.installed=!0,t.component("vueEsign",v))};var f=v,g=s("ed08"),d={name:"sign",components:{vueEsign:f},data:function(){return{title:"手写签名",lineWidth:5,lineColor:"#303133",resultImg:"",isCrop:!1,imgShow:!1}},mounted:function(){},methods:{emptySing:function(){this.imgShow=!1,this.$refs.esign.reset()},okSign:function(){var t=this;this.$refs.esign.generate().then((function(e){t.resultImg=e})).catch((function(){Object(g["c"])("您还没有签名")}))},viewSign:function(){this.okSign(),this.imgShow=!0}}},p=d,m=(s("bc43"),Object(u["a"])(p,i,a,!1,null,"ce964cbe",null));e["default"]=m.exports},bc43:function(t,e,s){"use strict";s("e9a9")},e9a9:function(t,e,s){}}]);